<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>docker | 逆天改命</title><meta name=google-adsense-account content="ca-pub-7732072032123305"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=keywords content><meta name=description content><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/tags/docker/index.xml rel=alternate type=application/rss+xml title=逆天改命><link href=/tags/docker/index.xml rel=feed type=application/rss+xml title=逆天改命><link rel=canonical href=https://linkall.pub/tags/docker/><meta property="og:title" content="docker"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://linkall.pub/tags/docker/"><meta itemprop=name content="docker"><meta itemprop=description content><meta name=twitter:card content="summary"><meta name=twitter:title content="docker"><meta name=twitter:description content></head><body class="ma0 avenir bg-near-white"><header><div class="pb3-m pb6-l bg-black"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">逆天改命</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav><div class="tc-l pv3 ph3 ph4-ns"><h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">docker</h1></div></div></header><main class=pb7 role=main><article class="cf pa3 pa4-m pa4-l"><div class="measure-wide-l center f4 lh-copy nested-copy-line-height nested-links mid-gray"><p>Below you will find pages that utilize the taxonomy term “docker”</p></div></article><div class="mw8 center"><section class="flex-ns flex-wrap justify-around mt5"><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/docker-modify-storage/ class="link black dim">docker修改存储位置</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">[toc]
背景 因为随着容器启动越来越多，存储占据越来越多的空间：/var/lib/docker/overlay2/，所以修改挂载位置，可以是外部空间等。
修改存储位置 停止服务 systemctl stop docker 将存储路径复制到新目录下 &lt;新目录> mkdir -p &lt;新目录> sudo rsync -aqxP /var/lib/docker/ &lt;新目录> 修改启动脚本/lib/systemd/system/docker.service。 # 将 [Service] Type=notify # the default is not to use systemd for cgroups because the delegate issues still # exists and systemd currently does not support the cgroup feature set required # for containers run by docker ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock # 修改为 ExecStart=/usr/bin/dockerd -g &lt;新目录> -H fd:// --containerd=/run/containerd/containerd.sock 重启服务 systemctl daemon-reload; systemctl start docker; 之前的目录可以清理了。</div><a href=/blog/docker-modify-storage/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/docker-dnsmasq-usage/ class="link black dim">使用Docker在内网搭建DNS服务器</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">dnsmasq 搭建web配置界面 使用jpillora提供的docker镜像。
用法 创建一个配置文件/opt/dnsmasq.conf，如下为demo
#dnsmasq config, for a complete example, see: # http://oss.segetech.com/intra/srv/dnsmasq.conf #log all dns queries log-queries #dont use hosts nameservers no-resolv #use cloudflare as default nameservers, prefer 1^4 server=1.0.0.1 server=1.1.1.1 strict-order #serve all .company queries using a specific nameserver server=/company/10.0.0.1 #explicitly define host-ip mappings address=/myhost.company/10.0.0.2 启动容器 $ docker run \ --name dnsmasq \ -d \ -p 53:53/udp \ -p 5380:8080 \ -v /opt/dnsmasq.conf:/etc/dnsmasq.conf \ --log-opt "max-size=100m" \ -e "HTTP_USER=foo" \ -e "HTTP_PASS=bar" \ --restart always \ jpillora/dnsmasq 其中： -e "HTTP_USER=foo" -e "HTTP_PASS=bar" 为为dnsmasq设定访问用户名和密码。访问地址：`</div><a href=/blog/docker-dnsmasq-usage/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div></section></div></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://linkall.pub/>&copy; 逆天改命 2024</a><div><div class=ananke-socials></div></div></div></footer></body></html>