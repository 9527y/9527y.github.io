<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>docker :: Tag :: 逆天改命</title><link>https://linkall.pub/tags/docker/index.html</link><description/><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Mon, 05 Jun 2023 12:52:58 +0000</lastBuildDate><atom:link href="https://linkall.pub/tags/docker/index.xml" rel="self" type="application/rss+xml"/><item><title>docker修改存储位置</title><link>https://linkall.pub/blog/docker-modify-storage/index.html</link><pubDate>Mon, 05 Jun 2023 12:52:58 +0000</pubDate><guid>https://linkall.pub/blog/docker-modify-storage/index.html</guid><description>[toc]
背景 因为随着容器启动越来越多，存储占据越来越多的空间：/var/lib/docker/overlay2/，所以修改挂载位置，可以是外部空间等。
修改存储位置 停止服务 systemctl stop docker 将存储路径复制到新目录下 &lt;新目录> mkdir -p &lt;新目录> sudo rsync -aqxP /var/lib/docker/ &lt;新目录> 修改启动脚本/lib/systemd/system/docker.service。 # 将 [Service] Type=notify # the default is not to use systemd for cgroups because the delegate issues still # exists and systemd currently does not support the cgroup feature set required # for containers run by docker ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock # 修改为 ExecStart=/usr/bin/dockerd -g &lt;新目录> -H fd:// --containerd=/run/containerd/containerd.sock 重启服务 systemctl daemon-reload; systemctl start docker; 之前的目录可以清理了。</description></item><item><title>使用Docker在内网搭建DNS服务器</title><link>https://linkall.pub/blog/docker-dnsmasq-usage/index.html</link><pubDate>Tue, 26 May 2020 18:22:39 +0000</pubDate><guid>https://linkall.pub/blog/docker-dnsmasq-usage/index.html</guid><description>dnsmasq 搭建web配置界面 使用jpillora提供的docker镜像。
用法 创建一个配置文件/opt/dnsmasq.conf，如下为demo
#dnsmasq config, for a complete example, see: # http://oss.segetech.com/intra/srv/dnsmasq.conf #log all dns queries log-queries #dont use hosts nameservers no-resolv #use cloudflare as default nameservers, prefer 1^4 server=1.0.0.1 server=1.1.1.1 strict-order #serve all .company queries using a specific nameserver server=/company/10.0.0.1 #explicitly define host-ip mappings address=/myhost.company/10.0.0.2启动容器 $ docker run \ --name dnsmasq \ -d \ -p 53:53/udp \ -p 5380:8080 \ -v /opt/dnsmasq.conf:/etc/dnsmasq.conf \ --log-opt "max-size=100m" \ -e "HTTP_USER=foo" \ -e "HTTP_PASS=bar" \ --restart always \ jpillora/dnsmasq其中：	-e "HTTP_USER=foo" -e "HTTP_PASS=bar" 为为dnsmasq设定访问用户名和密码。访问地址：`</description></item></channel></rss>