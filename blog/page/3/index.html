<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>逆天改命</title><meta name=google-adsense-account content="ca-pub-7732072032123305"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=keywords content><meta name=description content><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/blog/index.xml rel=alternate type=application/rss+xml title=逆天改命><link href=/blog/index.xml rel=feed type=application/rss+xml title=逆天改命><link rel=canonical href=https://linkall.pub/blog/><meta property="og:title" content="Blogs"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://linkall.pub/blog/"><meta itemprop=name content="Blogs"><meta itemprop=description content><meta name=twitter:card content="summary"><meta name=twitter:title content="Blogs"><meta name=twitter:description content></head><body class="ma0 avenir bg-near-white"><header><div class="pb3-m pb6-l bg-black"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">逆天改命</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav><div class="tc-l pv3 ph3 ph4-ns"><h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">Blogs</h1></div></div></header><main class=pb7 role=main><article class="pa3 pa4-ns nested-copy-line-height"><section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray"></section><section class="flex-ns flex-wrap justify-around mt5"><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/time-wait/ class="link black dim">Linux系统消除未被及时释放的TIME_WAIT状态的TCP连接</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Linux系统下，TCP连接断开后，会以TIME_WAIT状态保留一定的时间，然后才会释放端口。当并发请求过多的时候，就会产生大量的TIME_WAIT状态的连接，无法及时断开的话，会占用大量的端口资源和服务器资源。这个时候我们可以优化TCP的内核参数，来及时将TIME_WAIT状态的端口清理掉。
[root@web1 ~]netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' TIME_WAIT 1280 FIN_WAIT1 7 SYN_SENT 1 FIN_WAIT2 7 ESTABLISHED 247 LAST_ACK 1 我们只用关心TIME_WAIT的个数，在这里可以看到，有1280多个TIME_WAIT，这样就占用了1280多个端口，端口的数量只有65535个，占用一个少一个，会严重的影响到后继的新连接，就需调整下Linux的TCP内核参数，让系统更快的释放TIME_WAIT连接。
vi /etc/sysctl.conf 增加如下内容：
net.ipv4.tcp_syncookies = 1 #表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭； net.ipv4.tcp_tw_reuse = 1 #表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关闭； net.ipv4.tcp_tw_recycle = 1 #表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭； net.ipv4.tcp_fin_timeout = 30 #修改系統默认的 TIMEOUT 时间。 sysctl -p 让内核参数生效 流量小的机器一般就可以了，如果是大流量机器增加如下参数：
net.ipv4.tcp_keepalive_time = 1200 #表示当keepalive起用的时候，TCP发送keepalive消息的频度。缺省是2小时，改为20分钟。 net.ipv4.ip_local_port_range = 10000 65000 #表示用于向外连接的端口范围。缺省情况下很小：32768到61000，改为10000到65000。（注意：这里不要将最低值设的太低，否则可能会占用掉正常的端口！） net.ipv4.tcp_max_syn_backlog = 8192 #表示SYN队列的长度，默认为1024，加大队列长度为8192，可以容纳更多等待连接的网络连接数。 net.ipv4.tcp_max_tw_buckets = 6000 #表示系统同时保持TIME_WAIT的最大数量，如果超过这个数字，TIME_WAIT将立刻被清除并打印警告信息。默认180000，改为6000。对于Apache、Nginx等服务器，上几行的参数可以很好地减少TIME_WAIT套接字数量，但是对于 Squid，效果却不大。此项参数可以控制TIME_WAIT的最大数量，避免Squid服务器被大量的TIME_WAIT拖死。 内核其他TCP参数说明： net.</div><a href=/blog/time-wait/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/firefox-chrome-cookies/ class="link black dim">FireFox和Chrome浏览器Cookies存储路径记录</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Firefox Windows Cookie数据位于：%APPDATA%\Mozilla\Firefox\Profiles\ 目录中的xxx.default目录，名为cookies.sqlite的文件，如
C:\Users\xxx\AppData\Roaming\Mozilla\Firefox\Profiles\hsi4acx.default\cookies.sqlite Mac 官网
Finding your profile without opening Firefox Click the Finder icon in the dock. On the menu bar, click the Go menu, hold down the option or alt key and select Library. A window will open containing your Library folder. Open the Application Support folder, then open the Firefox folder, and then the Profiles folder. Your profile folder is within this folder. If you only have one profile, its folder would have &ldquo;default&rdquo; in the name.</div><a href=/blog/firefox-chrome-cookies/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/nginx-ssl/ class="link black dim">nginx 80端口重定向到443端口</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">使用如下配置即可
server { listen 80; server_name www.test.com; rewrite ^(.*)$ https://${server_name}$1 permanent; }</div><a href=/blog/nginx-ssl/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/bigsur-mkdir-data/ class="link black dim">macOS BigSur下无法在根目录创建/data解决方法</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">sudo vim /etc/synthetic.conf 添加
data /System/Volumes/Data/data /System/Volumes/Data/data目录为目标目录，(data和/xxx/data之间是tab不是空格)。
注意：如果/etc/synthetic.conf文件只读，不能编辑，请切换到root用户。
重启解决</div><a href=/blog/bigsur-mkdir-data/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/vue-router-history-nginx-config/ class="link black dim">vue-router的history模式nginx配置</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">原理是：将解析转为index.html页面
server { listen 80; server_name avue-data.meipinshu.cn; location / { index index.html; root /data/wwwroot; try_files $uri $uri/ /index.html; } }</div><a href=/blog/vue-router-history-nginx-config/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/resolve-update-xcode-error/ class="link black dim">解决MacOS升级后出现xcrun: error: invalid active developer path, missing xcrun的问题</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">升级Mac系统后，使用shell命令，或者node之类的报错：
xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun 解决方法，重装xcode command line：
xcode-select --install 如果没有解决问题，执行以下命令
sudo xcode-select -switch /</div><a href=/blog/resolve-update-xcode-error/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/npm-change-registry/ class="link black dim">npm换源</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">[toc]
一些镜像地址： 淘宝npm镜像 搜索地址：http://npm.taobao.org/ registry地址：http://registry.npm.taobao.org/ cnpmjs镜像 搜索地址：http://cnpmjs.org/ registry地址：http://r.cnpmjs.org/ 换源方法 npm临时换源 npm install express --registry=https://registry.npm.taobao.org 持久使用 npm config set registry https://registry.npm.taobao.org // 配置后可通过下面方式来验证是否成功 npm config get registry // 或npm info express 通过cnpm npm install -g cnpm --registry=https://registry.npm.taobao.org // 使用cnpm install expresstall express</div><a href=/blog/npm-change-registry/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/python-pip-mirror/ class="link black dim">python - pip换源，更换pip源到国内镜像</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">pip国内的一些镜像 阿里云 http://mirrors.aliyun.com/pypi/simple/ 中国科技大学 https://pypi.mirrors.ustc.edu.cn/simple/ 豆瓣(douban) http://pypi.douban.com/simple/ 清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/ 中国科学技术大学 http://pypi.mirrors.ustc.edu.cn/simple/ 修改源方法： 临时使用： 可以在使用pip的时候在后面加上-i参数，指定pip源
pip install scrapy -i https://pypi.tuna.tsinghua.edu.cn/simple 永久修改： linux: 修改 ~/.pip/pip.conf (没有就创建一个)， 内容如下： [global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple windows: 直接在user目录中创建一个pip目录，如：C:\Users\xx\pip，新建文件pip.ini，内容如下 [global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple</div><a href=/blog/python-pip-mirror/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/mac-finder-hide-show/ class="link black dim">Mac操作系统下怎么显示隐藏文件</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">第一步：打开「终端」应用程序。
第二步：输入如下命令：
defaults write com.apple.finder AppleShowAllFiles -boolean true ; killall Finder 第三步：按下「Return」键确认。
现在你将会在 Finder 窗口中看到那些隐藏的文件和文件夹了。
如果你想再次隐藏原本的隐藏文件和文件夹的话，将上述命令替换成
defaults write com.apple.finder AppleShowAllFiles -boolean false ; killall Finder</div><a href=/blog/mac-finder-hide-show/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/mac-lrzsz/ class="link black dim">mac终端Iterm2支持rz和sz的解决方案</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">在mac下，实现与服务器进行便捷的文件上传和下载操作：
安装支持rz和sz命令的lrzsz：
brew install lrzsz 在本地/usr/local/bin/目录下保存iterm2-send-zmodem.sh 和iterm2-recv-zmodem.sh两个脚本
两个文件链接：https://github.com/aikuyun/iterm2-zmodem
设置一下两个脚本的权限，一般 chmod 777 就行了 设置Iterm2的Tirgger特性，profiles->default->editProfiles->Advanced中的Tirgger
添加两条trigger，分别设置Regular expression，Action，Parameters，Instant如下： 1.第一条 Regular expression: rz waiting to receive.\*\*B0100 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-send-zmodem.sh Instant: checked 2.第二条 Regular expression: \*\*B00000000000000 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-recv-zmodem.sh Instant: checked</div><a href=/blog/mac-lrzsz/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div></section><ul class="pagination pagination-default"><li class=page-item><a href=/blog/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/blog/page/2/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/blog/ aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/blog/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class="page-item active"><a aria-current=page aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/blog/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/blog/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/blog/page/4/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/blog/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://linkall.pub/>&copy; 逆天改命 2024</a><div><div class=ananke-socials></div></div></div></footer></body></html>