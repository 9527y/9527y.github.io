<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>逆天改命</title><meta name=google-adsense-account content="ca-pub-7732072032123305"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=keywords content><meta name=description content><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/blog/index.xml rel=alternate type=application/rss+xml title=逆天改命><link href=/blog/index.xml rel=feed type=application/rss+xml title=逆天改命><link rel=canonical href=https://linkall.pub/blog/><meta property="og:title" content="Blogs"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://linkall.pub/blog/"><meta itemprop=name content="Blogs"><meta itemprop=description content><meta name=twitter:card content="summary"><meta name=twitter:title content="Blogs"><meta name=twitter:description content></head><body class="ma0 avenir bg-near-white"><header><div class="pb3-m pb6-l bg-black"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">逆天改命</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav><div class="tc-l pv3 ph3 ph4-ns"><h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">Blogs</h1></div></div></header><main class=pb7 role=main><article class="pa3 pa4-ns nested-copy-line-height"><section class="cf ph3 ph5-l pv3 pv4-l f4 tc-l center measure-wide lh-copy mid-gray"></section><section class="flex-ns flex-wrap justify-around mt5"><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/conditionalonproperty-base-usage/ class="link black dim">@ConditionalOnProperty来控制Configuration是否生效</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">注解解释 @Retention(RetentionPolicy.RUNTIME) @Target({ ElementType.TYPE, ElementType.METHOD }) @Documented @Conditional(OnPropertyCondition.class) public @interface ConditionalOnProperty { String[] value() default {}; //数组，获取对应property名称的值，与name不可同时使用 String prefix() default "";//property名称的前缀，可有可无 String[] name() default {};//数组，property完整名称或部分名称（可与prefix组合使用，组成完整的property名称），与value不可同时使用 String havingValue() default "";//可与name组合使用，比较获取到的属性值与havingValue给定的值是否相同，相同才加载配置 boolean matchIfMissing() default false;//缺少该property时是否可以加载。如果为true，没有该property也会正常加载；反之报错 boolean relaxedNames() default true;//是指命名方式 支持驼峰横线方式兼容 } } 使用 @Configuration //在application.properties配置"mf.assert"，对应的值为true @ConditionalOnProperty(prefix="mf",name = "assert", havingValue = "true") public class AssertConfig { @Autowired private HelloServiceProperties helloServiceProperties; @Bean public HelloService helloService(){ HelloService helloService = new HelloService(); helloService.setMsg(helloServiceProperties.getMsg()); return helloService; } }</div><a href=/blog/conditionalonproperty-base-usage/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/redis-master-slave-replicate/ class="link black dim">redis主从设置</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">预备知识： redis安装 配置 ##Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程 daemonize no ##当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定 pidfile /var/run/redis.pid ##指定Redis监听端口，默认端口为6379 port 6379 # TCP接收队列长度，受/proc/sys/net/core/somaxconn和tcp_max_syn_backlog这两个内核参数的影响 tcp-backlog 511 ##绑定的主机地址 bind 127.0.0.1 ##当 客户端闲置多长时间后关闭连接，如果指定为0，表示关闭该功能 timeout 300 # 如果非零，则设置SO_KEEPALIVE选项来向空闲连接的客户端发送ACK,用来定时向client发送tcp_ack包来探测client是否存活的 tcp-keepalive 60 ##指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose ## debug （大量信息，对开发/测试有用） ## verbose （很多精简的有用信息，但是不像debug等级那么多） ## notice （适量的信息，基本上是你生产环境中需要的） ## warning （只有很重要/严重的信息会记录下来） loglevel verbose ##日志名 logfile "./redis7003.log" ##设置数据库的数量，可以使用SELECT &lt;dbid>命令在连接上指定数据库id databases 16 ##持久化rdb文件，指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合save &lt;seconds> &lt;changes> #Redis默认配置文件中提供了三个条件： save 900 1 save 300 10 save 60 10000 分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。 # 默认如果开启RDB快照(至少一条save指令)并且最新的后台保存失败，Redis将会停止接受写操作 # 这将使用户知道数据没有正确的持久化到硬盘，否则可能没人注意到并且造成一些灾难 stop-writes-on-bgsave-error yes ##指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大 rdbcompression yes ###指定本地数据库文件名，默认值为dump.</div><a href=/blog/redis-master-slave-replicate/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/redis-sentinel-setting/ class="link black dim">redis哨兵机制</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">背景 我司使用仅有两台redis实例，所以不太适合做redis群集，比较适合使用redis哨兵机制。
原理 监控master故障时，使用投票机制（sdown，odown），判定是否故障，移除；选举新的slave作为master节点。redis.conf会随之变化。
哨兵机制关键配置 # 哨兵sentinel监控的redis主节点的 ip port # sentinel monitor &lt;master-name> &lt;ip> &lt;redis-port> &lt;quorum> sentinel monitor mymaster 172.16.8.206 6379 1 # Default is 3 minutes. 指定多少毫秒之后 主节点没有应答哨兵sentinel 此时 哨兵主观上认为主节点下线 默认30秒。 sentinel down-after-milliseconds mymaster 3000 启动 ./redis-sentinel sentinel.conf 注意 启动顺序：master->slave->sentinel master如果down掉，再启动不会他的角色是slave</div><a href=/blog/redis-sentinel-setting/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/redis-5-install/ class="link black dim">redis 5.x安装</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">下载地址：
https://redis.io/download 安装环境：
yum install -y gcc 编译安装
make distclean && make 修改配置
vi redis.conf 运行
src/redis-server redis.conf</div><a href=/blog/redis-5-install/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/zuul-ribbon-irule/ class="link black dim">zuul 自定义负载策略</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">定制IRule 使前后端开发可定制匹配, 学习并配置了网关的负载策略，zuul 底层使用的是 ribbon 的负载组件, ribbon 可以从 eureka 获取服务列表, 所以想要自定义负载, 得从 ribbon 入手, 查看并搜索 loadBalance 相关的类, 可以看到 AbstractLoadBalancerRule 这个类, 查看类树, 可以看到顶级接口为 IRule
/** * 决定最终的服务提供者 */ public Server choose(Object key); /** * 设置负载均衡器 */ public void setLoadBalancer(ILoadBalancer lb); /** * 拿到负载均衡器 */ public ILoadBalancer getLoadBalancer(); debug 分析, 得知 ribbon 默认的负载策略为: ZoneAvoidanceRule, 这个类继承自 AbstractLoadBalancerRule, AbstractLoadBalancerRule中存在 ILoadBalancer 属性, 可以获取负载器, 负载器中又可以获取服务列表等信息
所以我们只需要继承ZoneAvoidanceRule, 重写 choose 方法即可
ribbon 默认的负载器为: DynamicServerListLoadBalancer, 其中包括节点健康状态服务支持, 节点状态的更新(ServerListUpdater), 负载策略, 可用区域的分析, 可以从此类详细了解 ribbon 的运行机制</div><a href=/blog/zuul-ribbon-irule/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/nacos-config-usage/ class="link black dim">nacos 配置中心的使用</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">pom配置 在根pom.xml中设置
&lt;dependencyManagement> &lt;dependencies> &lt;dependency> &lt;groupId>com.alibaba.cloud&lt;/groupId> &lt;artifactId>spring-cloud-alibaba-dependencies&lt;/artifactId> &lt;version>2.2.1.RELEASE&lt;/version> &lt;type>pom&lt;/type> &lt;scope>import&lt;/scope> &lt;/dependency> &lt;/dependencies> &lt;/dependencyManagement> 在项目中增加依赖：
&lt;dependency> &lt;groupId>com.alibaba.cloud&lt;/groupId> &lt;artifactId>spring-cloud-starter-alibaba-nacos-config&lt;/artifactId> &lt;/dependency> 设置配置 Nacos Config 使用 DataId 和 GROUP 确定一个配置。 Data ID: nacos-config.properties Group : DEFAULT_GROUP 配置格式: Properties 配置内容： user.name=nacos-config-properties user.age=90 DataId 默认取 application-name，Group默认：default_group，类型后缀默认：*.properties 使用 增加bootstrap.propertie，配置文件来配置 Nacos Server 地址
spring.application.name=base-provider spring.cloud.nacos.config.server-addr=peer1:8848,peer2:8848,peer3:8848 logging.level.com.alibaba.nacos.client.naming=error logging.level.com.alibaba.nacos.config.log.level=error logging.level.com.alibaba.nacos.naming.log.level=error # 可以使用 spring.cloud.nacos.config.file-extension=yaml 这里我们使用 @Value 注解来将对应的配置注入到 HeartController 的 userName 和 age 字段，并添加 @RefreshScope 打开动态刷新功能
使用方法一： @RequestMapping("/heart") @RefreshScope @RestController public class HeartController { @Value("${server.</div><a href=/blog/nacos-config-usage/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/alipay-shortcuts/ class="link black dim">支付宝api，可以用于做IPhone的快捷操作</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">打开支付宝里面的搜索： alipayqr://platformapi/startapp?saId=20001003
支付宝收款码: alipayqr://platformapi/startapp?saId=20000123
支付宝扫一扫：alipayqr://platformapi/startapp?saId=10000007
支付宝付款：alipay://platformapi/startapp?appId=20000056
支付宝记账：alipay://platformapi/startapp?appId=20000168
支付宝滴滴：alipay://platformapi/startapp?appId=20000778
支付宝蚂蚁森林：alipay://platformapi/startapp?appId=60000002
支付宝转账：alipayqr://platformapi/startapp?saId=20000116
支付宝手机充值：alipayqr://platformapi/startapp?saId=10000003
支付宝卡包：alipayqr://platformapi/startapp?saId=20000021
支付宝吱口令：alipayqr://platformapi/startapp?saId=20000085
支付宝芝麻信用：alipayqr://platformapi/startapp?saId=20000118
支付宝红包：alipayqr://platformapi/startapp?saId=88886666
支付宝爱心：alipayqr://platformapi/startapp?saId=1000009
支付宝升级页面：alipayqr://platformapi/startapp?saId=2000066
支付宝滴滴打的：alipayqr://platformapi/startapp?saId=2000130
支付宝客服：alipayqr://platformapi/startapp?saId=2000691
支付宝生活：alipayqr://platformapi/startapp?saId=2000193
支付宝生活号：alipayqr://platformapi/startapp?saId=2000101
支付宝记账：alipayqr://platformapi/startapp?saId=2000168
公交车乘车码：alipay://platformapi/startapp?saId=200011235
蚂蚁森林：alipay://platformapi/startapp?saId=66666674&amp;clientVersion=3.7.0.0718</div><a href=/blog/alipay-shortcuts/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/what-is-cdn-back-address/ class="link black dim">cdn回源是什么意思</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">cdn回源是什么意思？CDN回源包括回源地址和加速域名。常规的CDN都是回源的。
原理 即：当有用户访问某一个URL的时候，如果被解析到的那个CDN节点没有缓存响应的内容，或者是缓存已经到期，就会回源站去获取。如果没有人访问，那么CDN节点不会主动去源站拿的。
回源地址 可以使回源域名，也可以是回源IP，主要作用是CDN加速节点同步更新的一个地址；
加速域名 使用CDN服务器需要加速的一个域名，一般会将加速域名做别名解析为CDN运营商提供的域名，来做CDN加速访问。
回源域名一般是cdn领域的专业术语，通常情况下，是直接用ip进行回源的，但是如果客户源站有多个ip，并且ip地址会经常变化，对于cdn厂商来说，为了避免经常更改配置（回源ip），会采用回源域名方式进行回源，这样即使源站的ip变化了，也不影响原有的配置。
CDN本来是给网站加速的，但是有时会因为不合适的回源策略给服务器带来负担，只有选择正确的策略才能给自己的网站带来更高的访问效率。</div><a href=/blog/what-is-cdn-back-address/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/linux-ssh-login/ class="link black dim">ssh 公钥认证方式登录（免密登录）</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">一般情况下,我们用ssh远程登录到服务器时，要输入用户名和密码。这对经常维护系统的人来说，很麻烦。怎样才能不用密码直接登录到远程的linux/unix服务器呢？ssh公钥认证可以解决这个问题。
公钥认证，是使用一对加密字符串，一个称为公钥(public key)， 任何人都可以看到其内容，用于加密；另一个称为密钥(private key)，只有拥有者才能看到，用于解密。 通过公钥加密过的密文使用密钥可以轻松解密，但根据公钥来猜测密钥却十分困难。
服务器端 在使用公钥认证之前，先检查一下服务器的ssh配置文件/etc/ssh/sshd_config
RSAAuthentication yes # 启用 RSA 认证，默认为yes PubkeyAuthentication yes # 启用公钥认证，默认为yes 如果配置没有问题，那么你就可以进行下一步了。
例子 下面我们举个例子，比如有两台机器，客户机A与服务器B，想用ssh公钥认证方式从A机器用client用户登录到B机器的server用户，方法如下：
在客户机A上生成公钥与密钥 [client@test ~]$ ssh-keygen -t rsa Generating public/private rsa key pair. Enter file in which to save the key (/home/client/.ssh/id_rsa): #此处直接按回车即可 Created directory '/home/client/.ssh'. Enter passphrase (empty for no passphrase): #此处直接按回车即可 Enter same passphrase again: #此处直接按回车即可 Your identification has been saved in /home/client/.ssh/id_rsa. Your public key has been saved in /home/client/.</div><a href=/blog/linux-ssh-login/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div><div class="relative w-100 w-30-l mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Blogs</span><h1 class="f3 near-black"><a href=/blog/teamview-uninstall/ class="link black dim">无法开机 ,报 不可恢复的错误：securityagent无法创建所要求的机制teamviewerauthplugin:start</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Mac os 10.15 使用CleanMyMac卸载TeamViewer后不能进入系统，报securityagent无法创建所要求的机制teamviewerauthplugin:start；
修复步骤如下
1、找个U盘或移动硬盘
2、下载链接:
链接: https://pan.baidu.com/s/10k-KvYceEy3IN0WKnoxN8w 提取码: ie6h 3、将下载好的TeamViewerAuthPlugin.bundle.tar.gz 复制到U盘或移动硬盘里；
4、按住command + R 开机；
5、先使用硬盘工具，将硬盘挂载上去，加密的硬盘，挂载时会提示你输入密码，输入你开机密码；
6、退出硬盘工具，使用命令终端，进入命令操作界面（点击顶部菜单栏【实用工具】 中的 【终端】）；
7、将刚才U盘或移动硬盘上的TeamViewerAuthPlugin.bundle.tar.gz，复制到/Volumes/Macintosh\ HD/Library/Security/SecurityAgentPlugins/目录下，Macintosh\ HD指的是你硬盘名；
8、解压TeamViewerAuthPlugin.bundle.tar.gz，命令：
tar -zxvf TeamViewerAuthPlugin.bundle.tar.gz 会生成一个TeamViewerAuthPlugin.bundle目录；确认 /Volumes/Macintosh\ HD/Library/Security/SecurityAgentPlugins/TeamViewerAuthPlugin.bundle是否已经有了；
9、重启搞定</div><a href=/blog/teamview-uninstall/ class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a></div></div></div></section><ul class="pagination pagination-default"><li class=page-item><a href=/blog/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/blog/page/4/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/blog/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/blog/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class="page-item active"><a aria-current=page aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/blog/page/6/ aria-label="Page 6" class=page-link role=button>6</a></li><li class=page-item><a href=/blog/page/7/ aria-label="Page 7" class=page-link role=button>7</a></li><li class=page-item><a href=/blog/page/6/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/blog/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://linkall.pub/>&copy; 逆天改命 2024</a><div><div class=ananke-socials></div></div></div></footer></body></html>