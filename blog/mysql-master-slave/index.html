<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Mysql5.7主从复制 | 逆天改命</title><meta name=google-adsense-account content="ca-pub-7732072032123305"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=keywords content><meta name=description content="环境 Linux:CentOS7 Mysql:5.7 服务器:腾讯云
安装 见：https://blog.csdn.net/haxyek/article/details/85273553 安装后可能需要的初始化命令：
mysqld --initialize-insecure --user=mysql --explicit_defaults_for_timestamp 主从复制原理 从服务器读取主服务器的binlog，进行数据复制。
主从复制实践 主服务器配置： 第一步：修改my.cnf文件 [mysqld]段增加
#启动而进制日志 log-bin=mysql-bin #服务器唯一ID，一般取IP最后一段 server-id=83 第二步：重启mysql服务 systemctl restart mysqld 第三步：主机给从机授权备份权限 登录到主机的mysql
myysql> GRANT REPLication slave on *.* to '从机用户名'@'从机ip地址' identified by '从机密码'; 示例
myysql> GRANT REPLication slave on *.* to 'slave'@'172.32.1.16' identified by 'slave_password'; 第四步：刷新权限 mysql>flush privileges; 第五步：查询master的状态 mysql>show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin."><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link rel=canonical href=https://linkall.pub/blog/mysql-master-slave/><meta property="og:title" content="Mysql5.7主从复制"><meta property="og:description" content="环境 Linux:CentOS7 Mysql:5.7 服务器:腾讯云
安装 见：https://blog.csdn.net/haxyek/article/details/85273553 安装后可能需要的初始化命令：
mysqld --initialize-insecure --user=mysql --explicit_defaults_for_timestamp 主从复制原理 从服务器读取主服务器的binlog，进行数据复制。
主从复制实践 主服务器配置： 第一步：修改my.cnf文件 [mysqld]段增加
#启动而进制日志 log-bin=mysql-bin #服务器唯一ID，一般取IP最后一段 server-id=83 第二步：重启mysql服务 systemctl restart mysqld 第三步：主机给从机授权备份权限 登录到主机的mysql
myysql> GRANT REPLication slave on *.* to '从机用户名'@'从机ip地址' identified by '从机密码'; 示例
myysql> GRANT REPLication slave on *.* to 'slave'@'172.32.1.16' identified by 'slave_password'; 第四步：刷新权限 mysql>flush privileges; 第五步：查询master的状态 mysql>show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin."><meta property="og:type" content="article"><meta property="og:url" content="https://linkall.pub/blog/mysql-master-slave/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-06-02T11:09:54+00:00"><meta property="article:modified_time" content="2020-06-02T11:09:54+00:00"><meta itemprop=name content="Mysql5.7主从复制"><meta itemprop=description content="环境 Linux:CentOS7 Mysql:5.7 服务器:腾讯云
安装 见：https://blog.csdn.net/haxyek/article/details/85273553 安装后可能需要的初始化命令：
mysqld --initialize-insecure --user=mysql --explicit_defaults_for_timestamp 主从复制原理 从服务器读取主服务器的binlog，进行数据复制。
主从复制实践 主服务器配置： 第一步：修改my.cnf文件 [mysqld]段增加
#启动而进制日志 log-bin=mysql-bin #服务器唯一ID，一般取IP最后一段 server-id=83 第二步：重启mysql服务 systemctl restart mysqld 第三步：主机给从机授权备份权限 登录到主机的mysql
myysql> GRANT REPLication slave on *.* to '从机用户名'@'从机ip地址' identified by '从机密码'; 示例
myysql> GRANT REPLication slave on *.* to 'slave'@'172.32.1.16' identified by 'slave_password'; 第四步：刷新权限 mysql>flush privileges; 第五步：查询master的状态 mysql>show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin."><meta itemprop=datePublished content="2020-06-02T11:09:54+00:00"><meta itemprop=dateModified content="2020-06-02T11:09:54+00:00"><meta itemprop=wordCount content="130"><meta itemprop=keywords content="mysql,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mysql5.7主从复制"><meta name=twitter:description content="环境 Linux:CentOS7 Mysql:5.7 服务器:腾讯云
安装 见：https://blog.csdn.net/haxyek/article/details/85273553 安装后可能需要的初始化命令：
mysqld --initialize-insecure --user=mysql --explicit_defaults_for_timestamp 主从复制原理 从服务器读取主服务器的binlog，进行数据复制。
主从复制实践 主服务器配置： 第一步：修改my.cnf文件 [mysqld]段增加
#启动而进制日志 log-bin=mysql-bin #服务器唯一ID，一般取IP最后一段 server-id=83 第二步：重启mysql服务 systemctl restart mysqld 第三步：主机给从机授权备份权限 登录到主机的mysql
myysql> GRANT REPLication slave on *.* to '从机用户名'@'从机ip地址' identified by '从机密码'; 示例
myysql> GRANT REPLication slave on *.* to 'slave'@'172.32.1.16' identified by 'slave_password'; 第四步：刷新权限 mysql>flush privileges; 第五步：查询master的状态 mysql>show master status; +------------------+----------+--------------+------------------+-------------------+ | File | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set | +------------------+----------+--------------+------------------+-------------------+ | mysql-bin."></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">逆天改命</a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Blogs</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Mysql5.7主从复制</h1><time class="f6 mv4 dib tracked" datetime=2020-06-02T11:09:54Z>June 2, 2020</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h1 id=环境>环境</h1><p>Linux:CentOS7
Mysql:5.7
服务器:腾讯云</p><h1 id=安装>安装</h1><p>见：https://blog.csdn.net/haxyek/article/details/85273553
安装后可能需要的初始化命令：</p><pre><code>mysqld --initialize-insecure --user=mysql --explicit_defaults_for_timestamp
</code></pre><h1 id=主从复制原理>主从复制原理</h1><p><img src="https://img-blog.csdnimg.cn/20190308105033670.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hheHllaw==,size_16,color_FFFFFF,t_70" alt=主从复制原理>
从服务器读取主服务器的binlog，进行数据复制。</p><h1 id=主从复制实践>主从复制实践</h1><h2 id=主服务器配置>主服务器配置：</h2><h3 id=第一步修改mycnf文件>第一步：修改my.cnf文件</h3><p>[mysqld]段增加</p><pre tabindex=0><code>#启动而进制日志
log-bin=mysql-bin
#服务器唯一ID，一般取IP最后一段
server-id=83
</code></pre><h3 id=第二步重启mysql服务>第二步：重启mysql服务</h3><pre tabindex=0><code>systemctl restart mysqld
</code></pre><h3 id=第三步主机给从机授权备份权限>第三步：主机给从机授权备份权限</h3><p>登录到主机的mysql</p><pre tabindex=0><code>myysql&gt; GRANT REPLication slave on *.* to &#39;从机用户名&#39;@&#39;从机ip地址&#39; identified by &#39;从机密码&#39;;
</code></pre><p>示例</p><pre tabindex=0><code>myysql&gt; GRANT REPLication slave on *.* to &#39;slave&#39;@&#39;172.32.1.16&#39; identified by &#39;slave_password&#39;;
</code></pre><h3 id=第四步刷新权限>第四步：刷新权限</h3><pre tabindex=0><code>mysql&gt;flush privileges;
</code></pre><h3 id=第五步查询master的状态>第五步：查询master的状态</h3><pre tabindex=0><code>mysql&gt;show master status;
+------------------+----------+--------------+------------------+-------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |
+------------------+----------+--------------+------------------+-------------------+
| mysql-bin.000002 |      601 |              |                  |                   |
+------------------+----------+--------------+------------------+-------------------+
</code></pre><h2 id=从服务器配置>从服务器配置</h2><h3 id=第一步修改mycnf文件-1>第一步：修改my.cnf文件</h3><pre tabindex=0><code>[mysqld]
server-id=16
</code></pre><h3 id=第二步重启并登录到mysql进行配置从服务器配置>第二步：重启并登录到mysql进行配置从服务器配置</h3><pre tabindex=0><code>mysql&gt; change master to 
 master_host = &#39;172.32.1.83&#39;,
 master_port=3306,
 master_user=&#39;slave&#39;,
 master_password=&#39;slave_password&#39;,
 master_log_file=&#39;mysql-bin.000002&#39;,
 master_log_pos=601
</code></pre><blockquote><p>注意：
master_port:mysql服务端口号，
master_user:为执行同步数据库账户
master_log_file:为主机show master status看到的File的值
master_log_pos:为主机show master status看到的position的值，不带引号
如果是想延迟同步可以使用master_delay = 1800 ，延迟1800秒</p></blockquote><h3 id=第三步检查从服务器的复制功能>第三步：检查从服务器的复制功能</h3><pre tabindex=0><code>mysql&gt; start slave;
</code></pre><h3 id=第四步检查从服务器复制功能状态>第四步：检查从服务器复制功能状态：</h3><pre tabindex=0><code>mysql&gt;show slave status \G;
………………………(省略若干)………………………
             Slave_IO_Running: Yes  # 此处应为YES
            Slave_SQL_Running: Yes # 此处应为YES
………………………(省略若干)………………………
</code></pre><h2 id=测试>测试</h2><p>以上步骤完成后，往主机中插入数据，看看从机中是否有数据。</p><ul class=pa0><li class="list di"><a href=/tags/mysql/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">mysql</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/blog/mysql-dbname-tablename/>Mysql 数据库名、表名大小写</a></li><li class=mb2><a href=/blog/mysql-bin-log-reverse/>mysql bin-log 误操作数据修复</a></li><li class=mb2><a href=/blog/mysql-base-config/>MySQL初始化基础配置</a></li><li class=mb2><a href=/blog/centos7-install-mysql/>一步一步CentOS7 安装 MySQL5.7</a></li><li class=mb2><a href=/blog/mysql-sql-monitor/>使用general_log来对Mysql SQL语句监控查看的记录</a></li><li class=mb2><a href=/blog/mysql-dump-usage/>使用mysqldump导出mysql表结构和表数据</a></li><li class=mb2><a href=/blog/mysql-view-database-table-capacity/>MySQL查看数据库表容量大小</a></li></ul></div></aside><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7732072032123305" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block data-ad-client=ca-pub-7732072032123305 data-ad-slot=6735921740 data-ad-format=auto data-full-width-responsive=true></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://linkall.pub/>&copy; 逆天改命 2024</a><div><div class=ananke-socials></div></div></div></footer></body></html>